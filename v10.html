<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Osaka 5-Day Strategy Â· Slow Travel Journal (v10)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg-body: #f4f1ea;
      --bg-card: #fdfaf6;
      --bg-hero: #efece5;
      --bg-chip: #fffbf5;
      --ink-main: #332c26;
      --ink-muted: #7d7266;
      --ink-soft: #a89c8e;
      --ink-accent: #a67c52;
      --border-soft: #e6ded5;
      --border-strong: #cbbba8;
      --accent: #b08d55;
      --accent-soft: rgba(176, 141, 85, 0.12);
      --shadow-soft: 0 10px 30px rgba(66, 56, 46, 0.08);
      --radius-card: 16px;
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      background: var(--bg-body);
      font-family: "Noto Serif TC", system-ui, -apple-system, BlinkMacSystemFont,
        "Segoe UI", sans-serif;
      color: var(--ink-main);
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }

    body {
      min-height: 100vh;
      padding: 14px 10px 90px;
    }

    @media (min-width: 768px) {
      body {
        display: flex;
        justify-content: center;
        padding: 32px 20px 110px;
      }
    }

    .app-shell {
      width: 100%;
      max-width: 900px;
      margin: 0 auto;
      background: var(--bg-card);
      border-radius: 20px;
      border: 1px solid rgba(166, 124, 82, 0.2);
      box-shadow: var(--shadow-soft);
      padding: 20px 16px 96px;
      position: relative;
      overflow: hidden;
    }

    @media (min-width: 768px) {
      .app-shell { padding: 32px 32px 110px; }
    }

    /* Texture Overlay for Whole App */
    .app-shell::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.04'/%3E%3C/svg%3E");
      pointer-events: none;
      z-index: 0;
    }

    .app-inner { position: relative; z-index: 1; }

    /* EDIT BUTTON */
    .edit-toggle {
      position: absolute;
      top: 18px;
      right: 18px;
      z-index: 50;
      background: rgba(255, 255, 255, 0.6);
      border: 1px solid var(--border-strong);
      padding: 4px 12px;
      border-radius: 99px;
      font-family: "Noto Serif TC", serif;
      font-size: 0.75rem;
      color: var(--ink-muted);
      cursor: pointer;
      transition: all 0.2s ease;
      letter-spacing: 0.05em;
    }
    .edit-toggle.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    [contenteditable="true"] {
      outline: 1px dashed var(--accent);
      outline-offset: 2px;
      background: rgba(255, 255, 255, 0.5);
    }

    .eyebrow {
      font-size: 0.75rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--ink-soft);
      font-family: system-ui, sans-serif;
      font-weight: 500;
    }

    h1, h2, h3, h4 { margin: 0; font-weight: 600; letter-spacing: 0.02em; }
    p { margin: 0 0 0.8em; line-height: 1.75; font-size: 0.95rem; color: var(--ink-main); }

    /* HERO */
    .hero {
      background: var(--bg-hero);
      border-radius: 18px;
      padding: 24px 20px;
      margin-bottom: 24px;
      position: relative;
    }

    .hero-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.6fr) minmax(0, 1fr);
      gap: 24px;
    }
    @media (max-width: 700px) { .hero-grid { grid-template-columns: 1fr; } }

    .hero-title { font-size: 1.6rem; margin-top: 8px; color: var(--ink-main); }
    .hero-subtitle { font-size: 0.92rem; color: var(--ink-muted); margin-top: 8px; line-height: 1.6; }

    .hero-meta-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 16px;
      align-items: center;
      font-size: 0.85rem;
      color: var(--ink-muted);
      font-family: system-ui, sans-serif;
    }
    .meta-item { display: inline-flex; align-items: center; gap: 6px; }

    .pill {
      display: inline-flex; align-items: center; gap: 6px;
      padding: 4px 12px;
      border-radius: 999px;
      background: #fff;
      border: 1px solid rgba(0,0,0,0.05);
      font-size: 0.75rem;
      color: var(--ink-muted);
      font-family: system-ui, sans-serif;
      box-shadow: 0 1px 2px rgba(0,0,0,0.03);
    }
    .pill-icon { width: 6px; height: 6px; border-radius: 50%; background: var(--accent); }

    /* Hero Secondary Card (Strategy) */
    .hero-secondary {
      background: #2c241b;
      border-radius: 14px;
      padding: 16px;
      color: #eaddcf;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      box-shadow: 0 10px 20px rgba(44, 36, 27, 0.25);
    }
    .hero-secondary h3 { font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.15em; color: #bcaaa4; margin-bottom: 8px; font-family: system-ui, sans-serif; }
    .hero-secondary p { color: rgba(234, 221, 207, 0.9); font-size: 0.88rem; margin-bottom: 12px; line-height: 1.6; }

    .tags { display: flex; flex-wrap: wrap; gap: 6px; }
    .tag {
      padding: 3px 8px;
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 4px;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: rgba(255,255,255,0.8);
      font-family: system-ui, sans-serif;
    }

    /* TIMELINE */
    .timeline { margin-top: 10px; padding-left: 10px; }
    .timeline-item { display: grid; grid-template-columns: 60px 1fr; gap: 16px; padding-bottom: 24px; position: relative; }

    .timeline-time {
      text-align: right;
      font-size: 0.85rem;
      color: var(--ink-muted);
      font-family: system-ui, sans-serif;
      padding-top: 2px;
      position: relative;
    }

    .timeline-line {
      position: absolute;
      top: 24px;
      right: -8px;
      bottom: -16px;
      width: 1px;
      background: rgba(166, 124, 82, 0.3);
      z-index: 0;
    }
    .timeline-item:last-child .timeline-line { display: none; }

    .timeline-dot {
      position: absolute;
      top: 6px;
      right: -12px;
      width: 9px;
      height: 9px;
      border-radius: 50%;
      background: #fff;
      border: 2px solid var(--accent);
      z-index: 1;
    }

    .timeline-card {
      background: #fff;
      border: 1px solid var(--border-soft);
      border-radius: 12px;
      padding: 14px 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.02);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .timeline-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.06);
      border-color: var(--border-strong);
    }

    .timeline-header { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 6px; }
    .timeline-title { font-size: 1rem; color: var(--ink-main); font-weight: 600; }
    .timeline-type { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--ink-soft); font-family: system-ui, sans-serif; }

    .timeline-location { font-size: 0.8rem; color: var(--ink-muted); margin-bottom: 8px; display: flex; align-items: center; gap: 4px; }
    .timeline-location a { color: var(--ink-accent); text-decoration: none; border-bottom: 1px dashed transparent; }
    .timeline-location a:hover { border-bottom-color: var(--ink-accent); }

    .timeline-body { font-size: 0.9rem; color: var(--ink-main); line-height: 1.6; }

    .keyword-link {
      color: var(--ink-accent);
      font-weight: 500;
      cursor: pointer;
      border-bottom: 1px dotted var(--ink-accent);
      transition: all 0.2s;
    }
    .keyword-link:hover { background: var(--accent-soft); }

    /* PHOTO BREAK */
    .photo-break {
      margin: 24px 0 10px;
      background: #fff;
      border: 1px solid var(--border-soft);
      border-radius: 12px;
      overflow: hidden;
      display: grid;
      grid-template-columns: 1fr;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    @media(min-width: 600px) { .photo-break { grid-template-columns: 1.2fr 1fr; } }

    .photo-wrapper {
      position: relative;
      min-height: 260px;
      overflow: hidden;
      background: #eae3da;
    }

    .photo-img-element {
      width: 100%;
      height: 100%;
      object-fit: cover;
      position: absolute;
      inset: 0;
      opacity: 1;
      filter: contrast(0.98) saturate(0.95);
    }

    .photo-content {
      padding: 24px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      background: rgba(255,255,255,0.85);
    }

    /* BOTTOM NAV */
    .bottom-nav {
      position: fixed; bottom: 0; left: 0; right: 0;
      background: rgba(253, 250, 246, 0.95);
      border-top: 1px solid var(--border-soft);
      backdrop-filter: blur(12px);
      padding: 10px 16px calc(10px + env(safe-area-inset-bottom));
      z-index: 100;
      display: flex; justify-content: center;
    }

    .nav-scroll {
      display: flex; gap: 8px; overflow-x: auto;
      padding-bottom: 4px; max-width: 100%;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    .nav-scroll::-webkit-scrollbar { display: none; }

    .nav-btn {
      flex: 0 0 auto;
      padding: 8px 14px;
      border-radius: 99px;
      background: transparent;
      border: 1px solid var(--border-strong);
      color: var(--ink-muted);
      font-size: 0.75rem;
      font-weight: 500;
      letter-spacing: 0.05em;
      cursor: pointer;
      transition: all 0.2s;
      display: flex; align-items: center; gap: 6px;
      font-family: system-ui, sans-serif;
      white-space: nowrap;
    }
    .nav-btn-dot { width: 6px; height: 6px; border-radius: 50%; background: transparent; border: 1px solid var(--ink-muted); }
    .nav-btn.active { background: var(--ink-main); color: #fff; border-color: var(--ink-main); }
    .nav-btn.active .nav-btn-dot { background: var(--accent); border-color: var(--accent); }
    .nav-btn.special { border-color: var(--accent); color: var(--ink-accent); }
    .nav-btn.special.active { background: var(--accent); color: #fff; }

    /* DRAWER & MODAL */
    .backdrop {
      position: fixed; inset: 0; background: rgba(30,25,20,0.4);
      z-index: 150; opacity: 0; pointer-events: none; transition: opacity 0.3s;
    }
    .backdrop.active { opacity: 1; pointer-events: auto; }

    .drawer {
      position: fixed; bottom: 0; left: 0; right: 0;
      background: #fdfaf6;
      border-radius: 20px 20px 0 0;
      max-height: 85vh;
      transform: translateY(105%);
      transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
      z-index: 160;
      display: flex; flex-direction: column;
      box-shadow: 0 -10px 40px rgba(0,0,0,0.2);
    }
    .drawer.active { transform: translateY(0); }

    .drawer-header {
      padding: 16px 20px;
      border-bottom: 1px solid var(--border-soft);
      display: flex; justify-content: space-between; align-items: center;
      background: rgba(253, 250, 246, 0.95);
      border-radius: 20px 20px 0 0;
    }
    .drawer-title { font-size: 1rem; font-weight: 600; color: var(--ink-main); }
    .drawer-close { background: none; border: none; font-size: 1.5rem; color: var(--ink-muted); cursor: pointer; padding: 0 8px; }
    .drawer-content { padding: 20px; overflow-y: auto; }

    .strategy-card {
      background: #fff;
      border: 1px solid var(--border-soft);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
    }
    .strategy-card h3 { font-size: 0.85rem; color: var(--ink-accent); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 10px; font-family: system-ui, sans-serif; }
    .strategy-card p { font-size: 0.9rem; margin-bottom: 8px; }
    .strategy-list li { margin-bottom: 6px; font-size: 0.9rem; color: var(--ink-muted); }

    .modal {
      position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.95);
      width: 90%; max-width: 420px;
      background: #fff;
      border-radius: 16px;
      padding: 24px;
      z-index: 170;
      opacity: 0; pointer-events: none;
      transition: all 0.2s;
      box-shadow: 0 20px 60px rgba(0,0,0,0.2);
    }
    .backdrop.active .modal { opacity: 1; pointer-events: auto; transform: translate(-50%, -50%) scale(1); }
    .modal-h { font-size: 1.1rem; margin-bottom: 4px; }
    .modal-sub { font-size: 0.75rem; text-transform: uppercase; color: var(--ink-soft); letter-spacing: 0.1em; margin-bottom: 16px; }
    .modal-body { font-size: 0.92rem; color: var(--ink-muted); line-height: 1.7; }
  </style>
</head>

<body>
<div class="app-shell">
  <button id="edit-toggle" class="edit-toggle">âœ EDIT</button>

  <div class="app-inner">
    <!-- Hero Section -->
    <header class="hero">
      <div class="hero-grid">
        <div>
          <div class="eyebrow" id="day-eyebrow">DAY 01 Â· ARRIVAL</div>
          <h1 class="hero-title" id="day-title">Arrival & Winter Gear</h1>
          <p class="hero-subtitle" id="day-subtitle">å¾å·¥ä½œæ¨¡å¼ç™»å‡ºï¼Œå°‡ç¬¬ä¸€å¤©çš„é‡é»æ”¾åœ¨ã€Œå†¬è£è£œé½Šã€èˆ‡ã€Œèª¿æ•´ç¯€å¥ã€ã€‚</p>

          <div class="hero-meta-row">
            <div class="pill"><span class="pill-icon"></span><span id="day-date">2025/12/15 Â· Mon</span></div>
            <div class="meta-item">ğŸ“ <span id="day-location">KIX Â· Rinku Town</span></div>
          </div>
        </div>

        <div class="hero-secondary">
          <div>
            <h3>ä»Šæ—¥ç­–ç•¥ Â· STRATEGY</h3>
            <p id="day-strategy">è‡¨ç©ºåŸæ ¸å¿ƒä»»å‹™ï¼šä¸€æ¬¡è§£æ±ºä¿æš–å¤–å¥—èˆ‡å†¬å­£é…ä»¶ï¼Œé¿å…å¾Œé¢å¹¾å¤©ç‚ºäº†è²·è¡£æœåˆ†å¿ƒã€‚</p>
          </div>
          <div class="tags" id="day-tags"></div>
        </div>
      </div>
    </header>

    <!-- Timeline -->
    <main id="timeline" class="timeline"></main>

    <!-- Photo Break -->
    <div class="photo-break">
      <div class="photo-wrapper" id="photo-wrapper">
        <img id="photo-img-element" class="photo-img-element" src="" alt="day visual" />
      </div>
      <div class="photo-content">
        <div class="eyebrow">VIBE CHECK</div>
        <h3 id="photo-title">Title</h3>
        <p id="photo-desc">Description</p>
      </div>
    </div>
  </div>
</div>

<!-- Bottom Navigation -->
<nav class="bottom-nav">
  <div class="nav-scroll" id="nav-container"></div>
</nav>

<!-- Drawer -->
<div class="backdrop" id="backdrop"></div>
<div class="drawer" id="drawer">
  <div class="drawer-header">
    <div class="drawer-title">æ—…ç¨‹å°æŠ„ Â· TRIP CHEAT SHEET</div>
    <button class="drawer-close" id="drawer-close">âœ•</button>
  </div>
  <div class="drawer-content">
    <div class="strategy-card">
      <h3>æ ¸å¿ƒåŸå‰‡ Â· CORE PRINCIPLES</h3>
      <p>æ…¢åŠæ‹ Ã— æœ‰ç­–ç•¥çš„åŸå¸‚æ—…è¡Œ</p>
      <ul class="strategy-list" style="padding-left: 20px; margin:0;">
        <li><strong>å†¬è£å…ˆæ±º</strong>ï¼šDay 1 æå®šä¿æš–ï¼Œå¾Œé¢åªé€›ä¸è²·é‡ç‰©ã€‚</li>
        <li><strong>ç¼ºè²¨é¢¨éšªç®¡ç†</strong>ï¼šDay 2 ä¸Šåˆå„ªå…ˆè™•ç†ç†±é–€å½©å¦ã€‚</li>
        <li><strong>å¥ˆè‰¯ç•™ç™½</strong>ï¼šDay 4 ä¸çœ‹åœ°åœ–ï¼Œåªçœ‹é¹¿èˆ‡æ¨¹ã€‚</li>
      </ul>
    </div>

    <div class="strategy-card">
      <h3>ä½å®¿ Â· HOTEL</h3>
      <p><strong>GRANBELL HOTEL OSAKA NAMBA</strong></p>
      <p style="font-size:0.85rem; color:var(--ink-muted);">å¤§é˜ªé›£æ³¢æ ¼è˜­è²çˆ¾é…’åº—<br>ã€’556-0011 å¤§é˜ªå¸‚æµªé€Ÿå€é›£æ³¢ä¸­2-6-7</p>
    </div>

    <div class="strategy-card">
      <h3>èˆªç­ Â· FLIGHTS (JL)</h3>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
        <div>
          <strong>å»ç¨‹ JL812</strong><br>
          <span style="font-size:0.8rem; color:var(--ink-muted);">08:20 TPE â†’ 11:50 KIX</span>
        </div>
        <div>
          <strong>å›ç¨‹ JL815</strong><br>
          <span style="font-size:0.8rem; color:var(--ink-muted);">19:20 KIX â†’ 21:35 TPE</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Detail Modal -->
<div class="modal" id="modal">
  <h3 class="modal-h" id="modal-title">Title</h3>
  <div class="modal-sub" id="modal-sub">Subtitle</div>
  <div class="modal-body" id="modal-body">Content</div>
</div>

<script>
  /* ===========================================================
     v10 í•µì‹¬ï¼šç…§ç‰‡æ”¹æˆ 100% å¯æ§çš„ã€Œå…§å»º SVG data URIã€
     =========================================================== */

  function svgDataURI({ title, subtitle, c1, c2, icon }) {
    const safe = (s) => String(s)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;");

    const svg = `
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1600 1000">
  <defs>
    <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="${c1}"/>
      <stop offset="100%" stop-color="${c2}"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="18" stdDeviation="18" flood-color="#000" flood-opacity="0.18"/>
    </filter>
  </defs>

  <rect width="1600" height="1000" fill="url(#g)"/>
  <circle cx="1280" cy="220" r="190" fill="#fff" opacity="0.14"/>
  <circle cx="1150" cy="340" r="90" fill="#fff" opacity="0.08"/>

  <g filter="url(#shadow)">
    <rect x="120" y="640" width="980" height="240" rx="34" fill="rgba(255,255,255,0.86)"/>
  </g>

  <text x="180" y="740" font-family="system-ui, -apple-system, Segoe UI" font-size="66" font-weight="800" fill="#2b2117">${safe(title)}</text>
  <text x="180" y="805" font-family="system-ui, -apple-system, Segoe UI" font-size="30" fill="rgba(43,33,23,0.62)">${safe(subtitle)}</text>

  <text x="1030" y="750" font-size="86">${safe(icon)}</text>

  <rect x="120" y="910" width="1360" height="2" fill="rgba(255,255,255,0.28)"/>
</svg>`.trim();

    const encoded = encodeURIComponent(svg)
      .replace(/'/g, "%27")
      .replace(/"/g, "%22");

    return "data:image/svg+xml;charset=utf-8," + encoded;
  }

  const modalDetails = {
    "TNF": "æ¨è–¦å‰å¾€ Rinku Outlet çš„åŒ—é¢å°ˆè³£åº—ï¼Œé€šå¸¸æ¬¾å¼æ¯”å¸‚å€å¤šä¸”æŠ˜æ‰£å¥½ã€‚é‡é»çœ‹ Mountain Light Jacket ç³»åˆ—ã€‚",
    "BEAMS": "Outlet çš„ BEAMS æœ‰å¾ˆå¤šé«˜å“è³ªçš„åŸºæœ¬æ¬¾æ¯›è¡£èˆ‡å¤§è¡£ï¼Œæ€§åƒ¹æ¯”æ¥µé«˜ã€‚",
    "EXCEL": "Excel çœ‰ç­†èˆ‡çœ¼å½± (GB08) åœ¨éŠå®¢å€å¸¸ç¼ºè²¨ï¼Œæ¢…ç”° LUCUA çš„ @cosme è²¨æºç›¸å°å……è¶³ã€‚",
    "CANMAKE": "é‡‘è“‹ç«æ¯›å¾©æ´»æ¶²èˆ‡æ–°è‰²è…®ç´…æ˜¯é‡é»ã€‚",
    "CPB": "è‚Œè†šä¹‹é‘° (ClÃ© de Peau BeautÃ©) åœ¨ç™¾è²¨å°ˆæ«ƒè³¼è²·å¯é€€ç¨…ã€‚å»ºè­°å…ˆçœ‹å¥½è‰²è™Ÿåœ–ç‰‡ç›´æ¥çµ¦æ«ƒå§çœ‹ã€‚",
  };

  const itinerary = [
    {
      id: 0,
      label: "DAY 01",
      date: "2025/12/15 Â· Mon",
      location: "KIX Â· Rinku Town",
      eyebrow: "DAY 01 Â· ARRIVAL",
      title: "Arrival & Winter Gear",
      subtitle: "æŠµé”èˆ‡å†¬è£è£œé½Šï¼šå¾å·¥ä½œæ¨¡å¼ç™»å‡ºï¼Œå°‡é‡é»æ”¾åœ¨ã€Œèª¿æ•´ç¯€å¥ã€ã€‚",
      strategy: "æ ¸å¿ƒä»»å‹™ï¼šåœ¨è‡¨ç©ºåŸä¸€æ¬¡è§£æ±ºä¿æš–å¤–å¥—ï¼ˆTNF / Patagoniaï¼‰èˆ‡é…ä»¶ï¼Œé¿å…å¾ŒçºŒè¡Œç¨‹ç‚ºäº†è²·è¡£æœè€Œä¸­æ–·ã€‚",
      tags: ["WINTER GEAR", "RINKU OUTLET", "SLOW START"],
      photo: {
        visual: { title:"RINKU", subtitle:"Arrival & Reset", icon:"ğŸ¡", c1:"#f6d365", c2:"#fda085" },
        title: "è‡¨ç©ºåŸçš„æ—¥è½",
        desc: "æµ·é¢¨ç•¥å¸¶å¯’æ„ï¼Œæ‘©å¤©è¼ªä¸‹çš„å¤•é™½å®£å‘Šå‡æœŸæ­£å¼é–‹å§‹ã€‚"
      },
      timeline: [
        { time: "11:50", type: "ARRIVAL", title: "æŠµé”é—œè¥¿æ©Ÿå ´ (JL812)", location: "KIX T1", desc: "ä¸‹æ©Ÿå¾Œä¸æ€¥è‘—é€²å¸‚å€ã€‚å…ˆæ„Ÿå—ä¸€ä¸‹æº«åº¦ï¼Œç¢ºèª ICOCA å¡èˆ‡ç¶²è·¯ç‹€æ…‹ã€‚" },
        { time: "13:30", type: "LUNCH", title: "Rinku Town åˆé¤", location: "Seaside Area", desc: "æ­ä¸€ç«™é›»è»Šåˆ° Rinku Townï¼Œåœ¨æµ·é‚Šé¤å»³ç°¡å–®ç”¨é¤ï¼Œçœ‹çœ‹æµ·ï¼Œè®“èº«é«”åˆ‡æ›æ™‚å€ã€‚" },
        { time: "15:00", type: "SHOPPING", title: "å†¬è£æˆ°ç•¥æ¡è³¼", location: "Rinku Premium Outlets",
          desc: "ç›®æ¨™æ˜ç¢ºï¼šä¿æš–å¤–å¥—ã€ç™¼ç†±è¡£ã€åœå·¾ã€‚<br>å„ªå…ˆé †åºï¼š<br>1. <strong>The North Face</strong> (ä¿æš–å±¤)<br>2. <strong>BEAMS</strong> (è³ªæ„Ÿå¤–å±¤)<br>3. å¥½èµ°çš„é‹",
          keywords: ["TNF","BEAMS"]
        },
        { time: "18:30", type: "MOVE", title: "å‰å¾€é›£æ³¢é£¯åº—", location: "Granbell Hotel Namba", desc: "æ­ä¹˜å—æµ·é›»éµé€²å¸‚å€ï¼ŒCheck-in æ”¾ç½®æˆ°åˆ©å“ï¼Œå»ºç«‹é€™äº”å¤©çš„åŸºåœ°ã€‚" },
        { time: "20:00", type: "DINNER", title: "è‡ªç”±è»’ é›£æ³¢æœ¬åº—", location: "Namba", desc: "ç°¡å–®åƒä¸€ä»½åç‰©å’–å“©ï¼Œæ—©é»å›é£¯åº—ä¼‘æ¯ï¼Œæ•´ç†æ˜æ—¥æˆ°ç•¥ã€‚" }
      ]
    },
    {
      id: 1,
      label: "DAY 02",
      date: "2025/12/16 Â· Tue",
      location: "Umeda Â· Kitahama",
      eyebrow: "DAY 02 Â· CITY STRATEGY",
      title: "Strategic Shopping & City Vibe",
      subtitle: "å…ˆè§£æ±ºæ¸…å–®ï¼Œå†æ…¢æ…¢èµ°ï¼šä¸Šåˆè™•ç†ç¼ºè²¨é¢¨éšªé«˜çš„å“é …ï¼Œä¸‹åˆç•™çµ¦æ²³å²¸èˆ‡å’–å•¡ã€‚",
      strategy: "ä¸Šåˆç²¾ç¥æœ€å¥½æ™‚å»æ¢…ç”°è™•ç†å°ˆæ«ƒèˆ‡ç†±é–€å½©å¦ï¼ˆExcel/Canmakeï¼‰ï¼Œä¸‹åˆå‰‡å®Œå…¨æ”¾é¬†ï¼Œä¸èƒŒè³¼ç‰©è¢‹é€›è¡—ã€‚",
      tags: ["SCARCITY SHOPPING", "KITAHAMA CAFE", "RIVER WALK"],
      photo: {
        visual: { title:"KITAHAMA", subtitle:"River & Calm", icon:"â˜•", c1:"#c3cfe2", c2:"#f5f7fa" },
        title: "åŒ—æ¿±çš„å¯§éœ",
        desc: "é›£æ³¢çš„å–§å›‚ä¹‹å¤–ï¼Œé€™è£¡æ˜¯å¤§é˜ªæœ€åƒæ­æ´²çš„è§’è½ã€‚"
      },
      timeline: [
        { time: "10:00", type: "SHOPPING", title: "æ¢…ç”°æˆ°ç•¥è³¼ç‰©", location: "LUCUA / Grand Front",
          desc: "é–å®šç¼ºè²¨é«˜é¢¨éšªå€ï¼š<br>â€¢ <strong>Excel</strong> / <strong>Canmake</strong><br>â€¢ <strong>CPB</strong>ï¼ˆè¶å…‰ç·šå¥½è©¦è‰²ï¼‰<br>â€¢ 3COINS çœ‹åˆ°å°±è²·",
          keywords: ["EXCEL","CANMAKE","CPB"]
        },
        { time: "13:30", type: "CHILL", title: "åŒ—æ¿±æ²³ç•”å’–å•¡", location: "Kitahama", desc: "è³¼ç‰©çµæŸï¼Œæ­è»Šåˆ°åŒ—æ¿±ã€‚æ‰¾é–“åº—çœ‹è‘—æ²³å·ç™¼å‘†ã€‚" },
        { time: "15:30", type: "WALK", title: "ä¸­å´ç”ºæ•£æ­¥", location: "Nakazakicho", desc: "åœ¨è€å±‹æ”¹å»ºçš„å°åº—é–“ç©¿æ¢­ã€‚åªçœ‹ä¸è²·ä¹Ÿç„¡æ‰€è¬‚ã€‚" },
        { time: "18:30", type: "DINNER", title: "é“é “å €ç¶“å…¸", location: "Dotonbori", desc: "å›åˆ°ç†±é¬§çš„é›£æ³¢ã€‚æ™šé¤éš¨æ„é¸æ“‡ã€‚" }
      ]
    },
    {
      id: 2,
      label: "DAY 03",
      date: "2025/12/17 Â· Wed",
      location: "Osaka Castle Park",
      eyebrow: "DAY 03 Â· SLOW DAY",
      title: "Castle Park & Winter Sun",
      subtitle: "æŠŠæ™‚é–“æ‹‰é•·ï¼šé‡é»æ˜¯å…¬åœ’æœ¬èº«çš„æ¨¹å½±èˆ‡è­·åŸæ²³ã€‚",
      strategy: "ä»Šæ—¥æ˜¯é«”åŠ›èª¿ç¯€æ—¥ã€‚æ˜¨å¤©æœªè²·é½Šçš„é«˜å–®åƒ¹å“ï¼Œä¸‹åˆå¯ä½œç‚ºå‚™æ¡ˆæ™‚é–“ã€‚",
      tags: ["OSAKA CASTLE", "RELAX", "BUFFER"],
      photo: {
        visual: { title:"OSAKA CASTLE", subtitle:"History & Green", icon:"ğŸ¯", c1:"#dfe9f3", c2:"#ffffff" },
        title: "è­·åŸæ²³çš„å€’å½±",
        desc: "ä¸éœ€è¦çˆ¬ä¸Šå¤©å®ˆé–£ï¼Œå…‰æ˜¯æ²¿è‘—çŸ³ç‰†èµ°ï¼Œå°±èƒ½æ„Ÿå—åˆ°æ­·å²çš„é‡é‡ã€‚"
      },
      timeline: [
        { time: "10:00", type: "WALK", title: "å¤§é˜ªåŸå…¬åœ’æ•£æ­¥", location: "Osaka Castle Park", desc: "å¾æ£®ä¹‹å®®ç«™é€²å…¥ï¼Œæ²¿è‘—å¤–åœæ…¢æ…¢èµ°ã€‚" },
        { time: "12:30", type: "LUNCH", title: "Jo-Terrace Osaka", location: "Osakajokoen Station", desc: "å…¬åœ’æ—çš„è¤‡åˆè¨­æ–½ï¼Œé¸æ“‡å¤šä¸”ç’°å¢ƒèˆ’é©ã€‚" },
        { time: "15:00", type: "BUFFER", title: "å¸‚å€å‚™æ¡ˆ / ä¼‘æ¯", location: "City Center", desc: "å¦‚æœæ²’è²·é½Šï¼Œå°±è£œè²¨ï¼›ç´¯äº†å°±å›é£¯åº—åˆç¡ã€‚" },
        { time: "18:30", type: "DINNER", title: "ç¦å¤ªéƒ å¤§é˜ªç‡’", location: "Namba", desc: "è”¥ç‡’æ˜¯å¿…é»ã€‚å¯èƒ½éœ€è¦æ’éšŠã€‚" }
      ]
    },
    {
      id: 3,
      label: "DAY 04",
      date: "2025/12/18 Â· Thu",
      location: "Nara",
      eyebrow: "DAY 04 Â· NATURE",
      title: "Nara Day Trip",
      subtitle: "é¹¿èˆ‡æ¨¹çš„ä¸€å¤©ï¼šæŠŠè³¼ç‰©æ…¾æœ›é™åˆ°æœ€ä½ï¼Œåªå¸¶ç›¸æ©Ÿèˆ‡å¥½èµ°çš„å¿ƒæƒ…ã€‚",
      strategy: "å¥ˆè‰¯ä¸æ˜¯æ‰“å¡æ¸…å–®ï¼Œè€Œæ˜¯ä¸€å€‹è®“æ™‚é–“è®Šæ…¢çš„åœ°æ–¹ã€‚ä¸è³¼ç‰©ã€ä¸è¶•è·¯ï¼Œé †è‘—é¹¿çš„æ­¥èª¿èµ°ã€‚",
      tags: ["DEER", "OLD TOWN", "NO SHOPPING"],
      photo: {
        visual: { title:"NARA", subtitle:"Deer & Silence", icon:"ğŸ¦Œ", c1:"#dfa579", c2:"#c79081" },
        title: "å¤éƒ½çš„çœ¼ç¥",
        desc: "é€™è£¡çš„é¹¿æ¯”äººæ›´åƒä¸»äººã€‚è¨˜å¾—æŠŠé¤…ä¹¾è—å¥½ï¼Œä¿æŒå„ªé›…çš„è·é›¢ã€‚"
      },
      timeline: [
        { time: "09:30", type: "TRAIN", title: "å‰å¾€å¥ˆè‰¯", location: "Kintetsu Nara", desc: "æ­ä¹˜è¿‘éµå‰å¾€å¥ˆè‰¯ã€‚è»Šç¨‹ç´„ 40 åˆ†é˜ã€‚" },
        { time: "10:30", type: "COFFEE", title: "Rokumei Coffee", location: "Nara", desc: "å…ˆå–ä¸€æ¯å† è»å’–å•¡ï¼Œè®“æ­¥èª¿æ…¢ä¸‹ä¾†ã€‚" },
        { time: "12:00", type: "LUNCH", title: "å¿—æ´¥é¦™ é‡œé£¯", location: "Nara Park Area", desc: "è‹¥æ’éšŠå¤ªé•·ï¼Œè½‰å¾€å¥ˆè‰¯ç”ºæ‰¾å®šé£Ÿä¹Ÿä¸éŒ¯ã€‚" },
        { time: "14:00", type: "WALK", title: "å¥ˆè‰¯å…¬åœ’ & è€è¡—", location: "Naramachi", desc: "é¿é–‹æœ€æ“æ“ è·¯ç·šï¼Œå¾€åƒé“æˆ–å¥ˆè‰¯ç”ºèµ°ã€‚æ‰¾é–“å’Œè“å­åº—ååã€‚" },
        { time: "17:30", type: "RETURN", title: "è¿”å›å¤§é˜ª", location: "Namba", desc: "æ™šé¤éš¨æ„ï¼Œä»Šæ™šæ—©é»ä¼‘æ¯ï¼Œæ•´ç†è¡Œæã€‚" }
      ]
    },
    {
      id: 4,
      label: "DAY 05",
      date: "2025/12/19 Â· Fri",
      location: "Namba Â· KIX",
      eyebrow: "DAY 05 Â· DEPARTURE",
      title: "Departure & Rituals",
      subtitle: "æŠŠæ—…ç¨‹æŠ˜æˆæ›¸ç±¤ï¼šæœ€å¾Œçš„å’–å•¡èˆ‡æœ€å¾Œçš„æ¡è²·ã€‚",
      strategy: "å›ç¨‹æ—¥çš„é‡é»æ˜¯ã€Œä¸éºæ¼ã€èˆ‡ã€Œå„€å¼æ„Ÿã€ã€‚æ©Ÿå ´ç•™çµ¦æœ€å¾Œä¸€æ¯å’–å•¡èˆ‡ä¼´æ‰‹ç¦®ã€‚",
      tags: ["AIRPORT", "LAST BUY", "GOODBYE"],
      photo: {
        visual: { title:"KIX", subtitle:"Goodbye Osaka", icon:"âœˆï¸", c1:"#a18cd1", c2:"#fbc2eb" },
        title: "é›¢é–‹çš„è¦–è§’",
        desc: "é€éæ©Ÿå ´çš„ç»ç’ƒçª—ï¼Œå†çœ‹ä¸€æ¬¡é€™åº§åŸå¸‚çš„å¤©ç©ºã€‚"
      },
      timeline: [
        { time: "10:00", type: "CHECKOUT", title: "é€€æˆ¿ & å¯„æ”¾è¡Œæ", location: "Granbell Hotel", desc: "å†æª¢æŸ¥ä¸€æ¬¡åºŠåº•èˆ‡æ’åº§ã€‚è£œæœ€å¾Œæ¶ˆè€—å“ã€‚" },
        { time: "12:00", type: "LUNCH", title: "æœ€å¾Œçš„å¤§é˜ªå‘³", location: "Namba", desc: "é¸æ“‡ä¸€å®¶é‚„æ²’åƒåˆ°çš„æ¸…å–®ï¼Œæˆ–ç°¡å–®æ”¶å°¾ã€‚" },
        { time: "14:30", type: "MOVE", title: "å‰å¾€é—œè¥¿æ©Ÿå ´", location: "Nankai Line", desc: "é ç•™å……è£•æ™‚é–“ï¼Œé¿å…è¶•è·¯ç ´å£æƒ…ç·’ã€‚" },
        { time: "16:00", type: "LAST STOP", title: "æ©Ÿå ´å„€å¼", location: "KIX Airside", desc: "æœ€å¾Œä¸€æ¯å’–å•¡ + ä¼´æ‰‹ç¦® + æº–å‚™ç™»æ©Ÿã€‚" }
      ]
    }
  ];

  const state = { activeDay: 0 };

  const els = {
    timeline: document.getElementById('timeline'),
    nav: document.getElementById('nav-container'),
    drawer: document.getElementById('drawer'),
    backdrop: document.getElementById('backdrop'),
    modal: document.getElementById('modal'),
    date: document.getElementById('day-date'),
    location: document.getElementById('day-location'),
    title: document.getElementById('day-title'),
    subtitle: document.getElementById('day-subtitle'),
    strategy: document.getElementById('day-strategy'),
    tags: document.getElementById('day-tags'),
    eyebrow: document.getElementById('day-eyebrow'),
    photoImgElement: document.getElementById('photo-img-element'),
    photoTitle: document.getElementById('photo-title'),
    photoDesc: document.getElementById('photo-desc'),
    editToggle: document.getElementById('edit-toggle'),
    closeDrawer: document.getElementById('drawer-close')
  };

  function init() {
    renderNav();
    loadDay(0);

    els.editToggle.addEventListener('click', toggleEdit);
    els.backdrop.addEventListener('click', closeAllOverlays);
    els.closeDrawer.addEventListener('click', closeAllOverlays);

    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('keyword-link')) {
        openModal(e.target.innerText, e.target.dataset.key);
      }
    });
  }

  function renderNav() {
    const frag = document.createDocumentFragment();

    itinerary.forEach((day, idx) => {
      const btn = document.createElement('button');
      btn.className = `nav-btn ${idx === 0 ? 'active' : ''}`;
      btn.innerHTML = `<span class="nav-btn-dot"></span><span>${day.label}</span>`;
      btn.onclick = () => loadDay(idx);
      frag.appendChild(btn);
    });

    const tripBtn = document.createElement('button');
    tripBtn.className = 'nav-btn special';
    tripBtn.innerHTML = `<span>TRIP</span>`;
    tripBtn.onclick = openDrawer;
    frag.appendChild(tripBtn);

    els.nav.innerHTML = '';
    els.nav.appendChild(frag);
  }

  function loadDay(idx) {
    state.activeDay = idx;
    const data = itinerary[idx];

    document.querySelectorAll('.nav-btn').forEach((b, i) => {
      if (i < itinerary.length) b.classList.toggle('active', i === idx);
    });

    els.title.innerText = data.title;
    els.subtitle.innerText = data.subtitle;
    els.date.innerText = data.date;
    els.location.innerText = data.location;
    els.eyebrow.innerText = data.eyebrow;
    els.strategy.innerText = data.strategy;

    els.tags.innerHTML = data.tags.map(t => `<span class="tag">${t}</span>`).join('');

    /* v10 é‡é»ï¼šåœ–ç‰‡æ”¹æˆå…§å»º SVG data URIï¼Œæ°¸é æˆåŠŸ */
    els.photoImgElement.src = svgDataURI(data.photo.visual);

    els.photoTitle.innerText = data.photo.title;
    els.photoDesc.innerText = data.photo.desc;

    renderTimeline(data.timeline);

    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  function renderTimeline(items) {
    els.timeline.innerHTML = items.map((item) => {
      let desc = item.desc;
      if (item.keywords) {
        item.keywords.forEach(kw => {
          if (modalDetails[kw]) {
            desc = desc.replaceAll(kw, `<span class="keyword-link" data-key="${kw}">${kw}</span>`);
          }
        });
      }

      return `
      <div class="timeline-item">
        <div class="timeline-time">
          ${item.time}
          <div class="timeline-dot"></div>
          <div class="timeline-line"></div>
        </div>
        <article class="timeline-card">
          <div class="timeline-header">
            <div class="timeline-title" contenteditable="false">${item.title}</div>
            <div class="timeline-type">${item.type}</div>
          </div>
          <div class="timeline-location">
            ğŸ“ <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.location)}" target="_blank" rel="noopener">${item.location}</a>
          </div>
          <div class="timeline-body" contenteditable="false">${desc}</div>
        </article>
      </div>
      `;
    }).join('');
  }

  function openDrawer() {
    els.backdrop.classList.add('active');
    els.drawer.classList.add('active');
  }

  function closeAllOverlays() {
    els.backdrop.classList.remove('active');
    els.drawer.classList.remove('active');
    els.modal.style.opacity = 0;
    els.modal.style.pointerEvents = 'none';
  }

  function openModal(title, key) {
    const content = modalDetails[key] || "æš«ç„¡è©³ç´°ç­–ç•¥è³‡è¨Šã€‚";
    document.getElementById('modal-title').innerText = title;
    document.getElementById('modal-sub').innerText = "SHOPPING STRATEGY";
    document.getElementById('modal-body').innerText = content;

    els.backdrop.classList.add('active');
    els.modal.style.opacity = 1;
    els.modal.style.pointerEvents = 'auto';
  }

  function toggleEdit() {
    const isEditable = els.editToggle.classList.toggle('active');
    const editables = document.querySelectorAll('[contenteditable]');
    editables.forEach(el => el.setAttribute('contenteditable', isEditable));
    els.editToggle.innerText = isEditable ? 'âœ“ SAVE' : 'âœ EDIT';
  }

  init();
</script>
</body>
</html>
